import java.util.Random;
import java.awt.event.KeyEvent;
import java.awt.Color;


public class ZombieMain {
	
	static boolean isZombieXOverlap(EZImage zombie) {
		int zombieLeftEdge = zombie.getXCenter() - zombie.getWidth()/2;
		int zombieRightEdge = zombie.getXCenter() + zombie.getWidth()/2;
		
		return (zombieLeftEdge <= survivorLeftEdge && zombieRightEdge >= (survivorLeftEdge + 30)) ||
				(zombieRightEdge >= survivorRightEdge && zombieLeftEdge <= (survivorRightEdge - 30));
	}
	
	static boolean isZombieYOverlap(EZImage zombie) {
		int zombieBottomEdge = zombie.getYCenter() + zombie.getHeight()/2;
		int zombieTopEdge = zombie.getYCenter() - zombie.getHeight()/2;
		
		return (zombieTopEdge <= survivorTopEdge && zombieBottomEdge >= (survivorTopEdge + 30)) ||
				(zombieTopEdge <= (survivorBottomEdge - 30) && zombieBottomEdge >= survivorBottomEdge);
	}
	
	static boolean isZombieOverlap(EZImage zombie) {
		return isZombieXOverlap(zombie) && isZombieYOverlap(zombie);
	}
	
	// static variables to hold our EZGraphics window dimensions
	static int screenWidth = 800;
	static int screenHeight = 800;
	
	// initialize our random number generator
	static Random randomGenerator = new Random();
	
	// variable to keep track of the time
	static long spawnTime = 0;
	
	// image to hold/track our "survivor" picture
	static EZImage survivor;
	
	// variables representing the edges of our survivor for purposes
	// of collision detection
	static int survivorRightEdge;
	static int survivorLeftEdge;
	static int survivorTopEdge;
	static int survivorBottomEdge;
	
	// arrays that will hold information about our zombies
	// one array to hold the image objects, one array to store their x-coordinates,
	// and one array to store their y-coordinates
	static final int maxZombies = 20;
	static EZImage[] zombiePics = new EZImage[maxZombies];
	
	// variable that will keep track of the number of zombies that we have spawned
	static int numZombies = 0;
	
	// variables to hold the random starting X and Y positions of our Zombies
	static int zombieX;
	static int zombieY;
	
	// boolean variable to keep track of whether the survivor is dead or alive
	static boolean survivorDead = false;
	

	public static void main(String[] args) {
		
		EZ.initialize(screenWidth, screenHeight);
		
		survivor = EZ.addImage("resources/survivor.png", screenWidth/2, screenHeight/2);
		spawnTime = System.currentTimeMillis();
		
		zombieX = randomGenerator.nextInt(50) + screenWidth;
		zombieY = randomGenerator.nextInt(50) + screenHeight;
		zombiePics[numZombies] = EZ.addImage("resources/Zombie.png", 
				zombieX, 
				zombieY);
		
		numZombies++;
		
		while (!survivorDead) {
			survivorRightEdge = survivor.getXCenter() + survivor.getWidth() / 2;
			survivorLeftEdge = survivor.getXCenter() - survivor.getWidth() / 2;
			survivorTopEdge = survivor.getYCenter() - survivor.getHeight() / 2;
			survivorBottomEdge = survivor.getYCenter() + survivor.getHeight() / 2;
			
			if (System.currentTimeMillis() > spawnTime + 30000 &&
					numZombies < maxZombies) {
				zombieX = randomGenerator.nextInt(50) + screenWidth;
				zombieY = randomGenerator.nextInt(50) + screenHeight;
				zombiePics[numZombies] = EZ.addImage("resources/Zombie.png", zombieX, zombieY);
				numZombies++;
				spawnTime += 30000;
			}
			
			if (EZInteraction.isKeyDown('d') && survivorRightEdge < screenWidth) {
				survivor.translateBy(10, 0);;
			} else if (EZInteraction.isKeyDown('a') && survivorLeftEdge > 0) {
				survivor.translateBy(-10, 0);
			} else if (EZInteraction.isKeyDown('w') && survivorTopEdge > 0) {
				survivor.translateBy(0, -10);
			} else if (EZInteraction.isKeyDown('s') && survivorBottomEdge < screenHeight) {
				survivor.translateBy(0, 10); 
			}
			
			for (int i = 0; i < numZombies; i++) {
				if (zombiePics[i].getXCenter() < survivor.getXCenter()) {
					zombiePics[i].translateBy(1.5, 0);	
				}
				if (zombiePics[i].getXCenter() > survivor.getXCenter()) {
					zombiePics[i].translateBy(-1.5, 0);
				}
				if (zombiePics[i].getYCenter() < survivor.getYCenter()) {
					zombiePics[i].translateBy(0, 1.5);
				}
				if (zombiePics[i].getYCenter() > survivor.getYCenter()) {
					zombiePics[i].translateBy(0, -1.5);
				}
				survivorDead = isZombieOverlap(zombiePics[i]);
			}
			
			EZ.refreshScreen();
		}
		EZ.removeAllEZElements();
		EZ.addText(screenWidth/2, screenHeight/2, "GAME OVER", Color.BLACK, 50);

	}

}
